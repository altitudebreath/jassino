"use strict";var Jassino=function(n){function r(n){if(s(n)){var t="";for(var e in n)t+=e+"::"+r(n[e])+"\n";return t}return String(n)}function t(n){console.log(n);var r="\n";for(var t in n)r+=t+": "+String(n[t])+"\n";return r}function e(n){function e(e,o,s){this.message=(n?n+": ":"\n")+(o||"DATA:")+" ==> \n"+r(e)+"\n"+(s?t(s):"")}return e.prototype=new Error,e.prototype.constructor=e,e}function o(n,r,t){return Array.prototype.slice.call(n,r,t)}function s(n){return"[object Object]"===Object.prototype.toString.call(n)&&n}function i(n){return"[object Array]"===Object.prototype.toString.call(n)}function a(n){return n?n.split(/\s*,\s*/):[]}function c(n,r,t){if(n===r)throw Error("Recursive assignment destination[fieldName] = destination! \n"+JSON.stringify(n)+"\n   fieldName: "+t);n[t]=r}function u(n,r){for(var t in r)if(r.hasOwnProperty(t)){var e=r[t];if(n===e)throw Error("Recursive assignment destination[fieldName] = destination! \n"+JSON.stringify(n)+"\n   fieldName: "+t);n[t]=e}return n}function f(n,r){for(var t=0;t<r.length;t++)u(n,r[t])}function l(r,t,e){var o=t[w],s=t[y],i=t[d];if(o){if(typeof e!==C)throw new n.MembersError(t,"Mixin cannot have class (static) members");p(e[w],o,e)}o&&delete t[w],s&&delete t[y],i&&delete t[d],p(r,t,e),o&&(t[w]=o),s&&(t[y]=s),i&&(t[d]=i)}function p(r,t,e){for(var o in t)if(t.hasOwnProperty(o)){var s,a=t[o],u=null,f=n.$$;i(a)?(s=a[a.length-1],u=a.slice(0,a.length-1)):s=a,u&&(typeof s===C&&-1!==u.indexOf(f.clsArg)&&(s=f.clsArg(e,s)),-1!==u.indexOf(f.cached)&&(s=f.cached(s))),c(r,s,o)}}function h(r){var t,e=n.ArgumentsError,o=0,a=r.length;if(2>a)throw new e(r,"Specify at least name and body");if(s(r[0]))o++,t=r[0];else{if(!r[0]||typeof r[0]!==O)throw new e(r,"First argument should be namespace or name");t=n.NS||null}var c={body:r[a-1],ns:t,name:r[o],sclass:null,smixins:null},u=a-(o+1)-1;if(!c.name||typeof c.name!==O)throw new e(c,"Invalid name");if(u>0){var f=" -> Parameters SHOULD BE: ([namespace,] name, [class,] [mixins_array,] body)",l=r[o+1];if(2==u){var p=r[o+2];if(typeof l!==C||!i(p))throw new e(c,"Super mixins and/or super class are invalid:"+l+","+p+f);c.sclass=l,c.smixins=p}else{if(1!=u)throw new e(c,"too many parameters");if(typeof l===C)c.sclass=l;else{if(!i(l))throw new e(c,"Class or mixins array is invalid: "+l+f);c.smixins=l}}}return c}function m(r,t){if(r.ns){if(typeof r.ns[r.name]!==S)throw new n.DuplicationError(r);r.ns[r.name]=t}}var y="_",d="__",w="cls",g="__cls_proto",v="__name__",_="__child__",b="__super__",E="super",x="__jassino__";n.DuplicationError=e("Duplication"),n.ArgumentsError=e("Arguments"),n.ConstructorError=e("Constructor"),n.InstantiationError=e("Instantiation"),n.MembersError=e("Members"),n.useGlobalScope=function(r){var t=r||window;t.Class=n.Class,t.Mixin=n.Mixin,t.$$=n.$$,t.Jassino=n},n.setDefaultNS=function(n){return this.NS=n};var S="undefined",C="function",O="string";return n.Mixin=function(){var n=h(arguments),r={};if(m(n,r),n.smixins&&f(r,n.smixins),n.body[y])throw new AE(n,"Mixin should not contain the constructor!");return l(r,n.body),r},n.Class=function(){var r,t=h(arguments),e=t.body,s=t.sclass,i=e[y],c=e[d],u=function(){throw new n.InstantiationError({},'use "new": new ClassA()')};if(i&&"auto"!==i)if(typeof i===C)r=function(){this[x]||u();try{var r=o(arguments);r.unshift(s),i.apply(this,r)}catch(t){throw new n.ConstructorError(t.message,"\n[Hint1: Recursive call by constructor to itself ??]\n[Hint2: Need Super call ??]\n",t)}finally{}};else{if(typeof i!==O)throw new n.ConstructorError(i,"Invalid constructor");var p=a(i);if(c){if(!(c>0))throw new n.ConstructorError(c,"Invalid number of the Super constructor arguments");if(!s)throw new n.ConstructorError(i,"__: '"+c+"' assumes SuperClass presence");r=function(){this[x]||u(),s.apply(this,o(arguments,0,c));for(var n=c;n<p.length;n++)this[p[n]]=arguments[n]}}else{if(s&&typeof c===S)throw new n.ConstructorError(i,"_: '"+i+"' -- Class and SuperClass shortcut notations must be present both!");r=function(){this[x]||u();for(var n=0;n<p.length;n++)this[p[n]]=arguments[n]}}}else r=s?function(){this[x]||u(),s.apply(this,arguments)}:function(){this[x]||u()};if(m(t,r),s){s[v];r.prototype=Object.create(s.prototype),r.prototype.constructor=r,r[w]=s[g]?Object.create(s[g]):{},r.prototype[E]=function(n,r){return console.log(n),n[b].prototype[r].apply(this,o(arguments,2))},r[b]=s}else r[w]={};return t.smixins&&f(r.prototype,t.smixins),l(r.prototype,e,r),r[g]=Object.create(r[w]),r[w][_]=r,r[v]=t.name,r.prototype[_]=r,r.prototype[x]=!0,r},n.$$={clsArg:function(n,r){return function(){var t=o(arguments);return t.unshift(n),r.apply(this,t)}},cached:function(n){var r=function(){return r._cache?r._cache:(r._cache=n.apply(this,arguments),r._cache)};return r._cache=null,r}},n}({});module&&(module.exports=Jassino);