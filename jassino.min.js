"use strict";var Jassino=function(n){function r(n){if(i(n)){var t="";for(var e in n)t+=e+"::"+r(n[e])+"\n";return t}return String(n)}function t(n){console.log(n);var r="\n";for(var t in n)r+=t+": "+String(n[t])+"\n";return r}function e(n){function e(e,o,i){this.message=(n?n+": ":"\n")+(o||"DATA:")+" ==> \n"+r(e)+"\n"+(i?t(i):"")}return e.prototype=new Error,e.prototype.constructor=e,e}function o(n,r,t){return Array.prototype.slice.call(n,r,t)}function i(n){return"[object Object]"===Object.prototype.toString.call(n)&&n}function s(n){return"[object Array]"===Object.prototype.toString.call(n)}function a(n){return n?n.split(/\s*,\s*/):[]}function u(n,r,t){if(n===r)throw Error("Recursive assignment destination[fieldName] = destination! \n"+JSON.stringify(n)+"\n   fieldName: "+t);n[t]=r}function c(n,r){for(var t in r)if(r.hasOwnProperty(t)){var e=r[t];if(n===e)throw Error("Recursive assignment destination[fieldName] = destination! \n"+JSON.stringify(n)+"\n   fieldName: "+t);n[t]=e}return n}function f(n,r){for(var t=0;t<r.length;t++)c(n,r[t])}function l(r,t,e){for(var o in t)if(t.hasOwnProperty(o)){if(o===m||o===y)continue;var i=r;if(0===o.indexOf(w)){if(typeof e!==E)throw new n.MembersError(t,"Mixin cannot have class (static) members");i=e}var a,c=t[o],f=null,l=n.$$;s(c)?(a=c[c.length-1],f=c.slice(0,c.length-1)):a=c,f?(typeof a===E&&-1!==f.indexOf(l.cls)&&(a=l.cls(e,a)),-1!==f.indexOf(l.cached)&&(a=l.cached(a))):a=i===e&&typeof a===E?l.cls(e,a):a,u(i,a,o)}}function p(r){var t,e=n.ArgumentsError,o=0,a=r.length;if(2>a)throw new e(r,"Specify at least name and body");if(i(r[0]))o++,t=r[0];else{if(!r[0]||typeof r[0]!==S)throw new e(r,"First argument should be namespace or name");t=n.NS||null}var u={body:r[a-1],ns:t,name:r[o],sclass:null,smixins:null},c=a-(o+1)-1;if(!u.name||typeof u.name!==S)throw new e(u,"Invalid name");if(c>0){var f=" -> Parameters SHOULD BE: ([namespace,] name, [class,] [mixins_array,] body)",l=r[o+1];if(2==c){var p=r[o+2];if(typeof l!==E||!s(p))throw new e(u,"Super mixins and/or super class are invalid:"+l+","+p+f);u.sclass=l,u.smixins=p}else{if(1!=c)throw new e(u,"too many parameters");if(typeof l===E)u.sclass=l;else{if(!s(l))throw new e(u,"Class or mixins array is invalid: "+l+f);u.smixins=l}}}return u}function h(r,t){if(r.ns){if(typeof r.ns[r.name]!==x)throw new n.DuplicationError(r);r.ns[r.name]=t}}var m="_",y="__",w="cls",d="__name__",v="__child__",g="__super__",_="super",b="__jassino__";n.DuplicationError=e("Duplication"),n.ArgumentsError=e("Arguments"),n.ConstructorError=e("Constructor"),n.InstantiationError=e("Instantiation"),n.MembersError=e("Members"),n.useGlobalScope=function(r){var t=r||window;t.Class=n.Class,t.Mixin=n.Mixin,t.$$=n.$$,t.Jassino=n},n.setDefaultNS=function(n){return this.NS=n};var x="undefined",E="function",S="string";return n.Mixin=function(){var n=p(arguments),r={};if(h(n,r),n.smixins&&f(r,n.smixins),n.body[m])throw new AE(n,"Mixin should not contain the constructor!");return l(r,n.body),r},n.Class=function(){var r,t=p(arguments),e=t.body,i=t.sclass,s=e[m],u=e[y],w=function(){throw new n.InstantiationError({},'use "new": new ClassA()')};if(s&&"auto"!==s)if(typeof s===E)r=function(){this[b]||w();try{var r=o(arguments);r.unshift(i),s.apply(this,r)}catch(t){throw new n.ConstructorError(t.message,"\n[Hint1: Recursive call by constructor to itself ??]\n[Hint2: Need Super call ??]\n",t)}finally{}};else{if(typeof s!==S)throw new n.ConstructorError(s,"Invalid constructor");var C=a(s);if(u){if(!(u>0))throw new n.ConstructorError(u,"Invalid number of the Super constructor arguments");if(!i)throw new n.ConstructorError(s,"__: '"+u+"' assumes SuperClass presence");r=function(){this[b]||w(),i.apply(this,o(arguments,0,u));for(var n=u;n<C.length;n++)this[C[n]]=arguments[n]}}else{if(i&&typeof u===x)throw new n.ConstructorError(s,"_: '"+s+"' -- Class and SuperClass shortcut notations must be present both!");r=function(){this[b]||w();for(var n=0;n<C.length;n++)this[C[n]]=arguments[n]}}}else r=i?function(){this[b]||w(),i.apply(this,arguments)}:function(){this[b]||w()};if(h(t,r),i){i[d];r.prototype=Object.create(i.prototype),r.prototype.constructor=r,c(r,i),r.prototype[_]=function(n,r){return n[g].prototype[r].apply(this,o(arguments,2))},r[g]=i}return t.smixins&&f(r.prototype,t.smixins),l(r.prototype,e,r),r[d]=t.name,r.prototype[v]=r,r.prototype[b]=!0,r},n.$$={cls:function(n,r){return function(){var t=o(arguments);return t.unshift(n),r.apply(this,t)}},cached:function(n){var r=function(){return r._cache?r._cache:(r._cache=n.apply(this,arguments),r._cache)};return r._cache=null,r}},n}({});module&&(module.exports=Jassino);